<!--yml
category: 未分类
date: 0001-01-01 00:00:00
--->

# 使用过 Redis 分布式锁么，它是什么回事？

> 原文：[https://zwmst.com/2387.html](https://zwmst.com/2387.html)

   [ *Redis* ](https://zwmst.com/redis)*[ <time datetime="2021-08-24T08:22:09+08:00"> 2021-08-24 </time> ](https://zwmst.com/2387.html)  先拿 setnx 来争抢锁，抢到之后，再用 expire 给锁加一个过期时间防止锁忘记了释放。
这时候对方会告诉你说你回答得不错，然后接着问如果在 setnx 之后执行expire 之前进程意外 crash 或者要重启维护了，那会怎么样？
这时候你要给予惊讶的反馈：唉，是喔，这个锁就永远得不到释放了。
紧接着你需要抓一抓自己得脑袋，故作思考片刻，好像接下来的结果是你主动思考出来的，然后回答：我记得 set 指令有非常复杂的参数，这个应该是可以同时把 setnx 和 expire 合成一条指令来用的！
对方这时会显露笑容，心里开始默念：摁，这小子还不错。*