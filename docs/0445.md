<!--yml
category: 未分类
date: 0001-01-01 00:00:00
-->

# Eureka和zookeeper都可以提供服务注册与发现的功能，两者的区别

> 原文：[https://zwmst.com/859.html](https://zwmst.com/859.html)

   [ *Spring Cloud* ](https://zwmst.com/spring-cloud)*[ <time datetime="2021-08-14T08:26:06+08:00"> 2021-08-14 </time> ](https://zwmst.com/859.html)  Zookeeper保证了CP(C：一致性，P：分区容错性)，Eureka保证了AP(A：高可用，P：分区 容错)

1、Zookeeper—–当向注册中心查询服务列表时，我们可以容忍注册中心返回的是几分钟 以前的信息，但不能容忍直接down掉不可用的。也就是说服务注册功能对高可用性要求比较 高，但是zk会出现这样的一种情况，当master节点因为网络故障与其他节点失去联系时，剩 余的节点会重新选leader。问题在于，选取leader的时间过长(30~120s)，且选取期间zk集群 都不可用，这样就会导致选取期间注册服务瘫痪。在云部署的环境下，因网络问题使得zk集群 失去master节点是较大概率会发生的事，虽然服务最终恢复，但是漫长的选择时间导致的注册 长期不可用是不能容忍的

2、Eureka则看明白这一点，因此再设计的优先保证了高可用性。Eureka各个节点都是平等 的，几个节点挂掉不会影响到正常节点的工作，剩余的节点依然可以提供注册和查询服务。而 Eureka的客户端再向某个Eureka注册时如果发现连接失败，则会自动切换至其他节点，只要 有一台Eureka还在，就能保证注册服务的可用(保证可用性)，只不过查到的信息可能不是最新 的(不保证一致性)。除此之外Eureka还有一种自我保护机制，如果在15分钟内超过85%的节 点都没有正常心跳，那么Eureka就认为客户端与注册中心出现了网络故障，此时就会出现以下 几种情况：

1>、Eureka不再从注册列表移除因为长时间没收到心跳而应该过期的服务

2>、Eureka仍然能够接受新服务的注册和查询请求，但是不会被同步到其它节点上(保证当前 节点可用)

3>、当网络稳定时，当前实例新的注册信息会被同步到其它节点中 Eureka还有客户端缓存功能(Eureka分为客户端程序和服务器端程序两个部分，客户端程序负 责向外提供注册与发现服务接口)。所以即便Eureka集群中所有节点都失效，或者发生网络分 隔故障导致客户端不能访问任何一台Eureka服务器；Eureka服务的消费者任然可以通过 Eureka客户端缓存来获取所有的服务注册信息。甚至最极端的环境下，所有正常的Eureka节 点都不对请求产生响应也没有更好的服务器解决方案来解决这种问题时；得益于Eureka的客户 端缓存技术，消费者服务仍然可以通过Eureka客户端查询与获取注册服务信息，这点很重要， 因此Eureka可以很好的应对网络故障导致部分节点失去联系的情况，而不像Zookeeper那样 使整个注册服务瘫痪。*