<!--yml
category: 未分类
date: 0001-01-01 00:00:00
--->

# 1242.redis 主从复制如何实现的？redis 的集群模式如何实现？redis 的 key 是如何寻址的？

> 原文：[https://zwmst.com/5793.html](https://zwmst.com/5793.html)

   [ *Redis* ](https://zwmst.com/redis)*[ <time datetime="2021-11-01T00:12:03+08:00"> 2021-10-31 </time> ](https://zwmst.com/5793.html)  主从复制实现：主节点将自己内存中的数据做一份快照，将快照发给从节点，从节点将数据恢复到内存中。之后再每次增加新数据的时候，主节点以类似于 mysql 的二进制日志方式将语句发送给从节点，从节点拿到主节点发送过来的语句进行重放。
分片方式：

1.  客户端分片
2.  基于代理的分片
    1.  Twemproxy
    2.  codis
        3.路由查询分片
    3.  Redis-cluster（本身提供了自动将数据分散到 Redis Cluster 不同节点的能力，整个数据集合的某个数据子集存储在哪个节点对于用户来说是透明的）redis-cluster 分片原理：Cluster 中有一个 16384 长度的槽(虚拟槽)，编号分别为 0-16383。每个 Master 节点都会负责一部分的槽，当有某个 key 被映射到某个 Master 负责的槽，那么这个 Master 负责为这个 key 提供服务，至于哪个 Master 节点负责哪个槽，可以由用户指定，也可以在初始化的时候自动生成，只有 Master 才拥有槽的所有权。Master 节点维护着一个 16384/8 字节的位序列，Master 节点用 bit 来标识对于某个槽自己是否拥有。比如对于编号为 1 的槽，Master 只要判断序列的第二位（索引从 0 开始）是不是为 1 即可。这种结构很容易添加或者删除节点。比如如果我想新添加个节点 D, 我需要从节点 A、B、C 中得部分槽到 D 上。*