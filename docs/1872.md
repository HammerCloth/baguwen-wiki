<!--yml
category: 未分类
date: 0001-01-01 00:00:00
-->

# 519.一致性 Hash 原理

> 原文：[https://zwmst.com/4121.html](https://zwmst.com/4121.html)

   [ *数据结构与算法* ](https://zwmst.com/%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84%e4%b8%8e%e7%ae%97%e6%b3%95)*[ <time datetime="2021-09-27T00:16:31+08:00"> 2021-09-26 </time> ](https://zwmst.com/4121.html)  ### 建构环形 hash 空间：

1.  考虑通常的 hash 算法都是将 value 映射到一个 32 为的 key 值，也即是 0~2^32-1 次方的数值空间；我们可以将这个空间想象成一个首（ 0 ）尾（ 2^32-1 ）相接的圆环。

### 把需要缓存的内容(对象)映射到 hash 空间

2.  接下来考虑 4 个对象 object1~object4 ，通过 hash 函数计算出的 hash 值 key 在环上的分布

### 把服务器(节点)映射到 hash 空间

3.  Consistent hashing 的基本思想就是将对象和 cache 都映射到同一个 hash 数值空间中，并且使用相同的 hash 算法。一般的方法可以使用 服务器(节点) 机器的 IP 地址或者机器名作为hash 输入。

### 把对象映射到服务节点

4.  现在服务节点和对象都已经通过同一个 hash 算法映射到 hash 数值空间中了，首先确定对象hash 值在环上的位置，从此位置沿环顺时针“行走”，第一台遇到的服务器就是其应该定位到的服务器。*