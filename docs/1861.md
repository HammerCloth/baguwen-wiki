<!--yml
category: 未分类
date: 0001-01-01 00:00:00
-->

# 508.Zab

> 原文：[https://zwmst.com/4097.html](https://zwmst.com/4097.html)

   [ *数据结构与算法* ](https://zwmst.com/%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84%e4%b8%8e%e7%ae%97%e6%b3%95)*[ <time datetime="2021-09-26T01:25:52+08:00"> 2021-09-25 </time> ](https://zwmst.com/4097.html)  ZAB( ZooKeeper Atomic Broadcast , ZooKeeper 原子消息广播协议）协议包括两种基本的模式：崩溃恢复和消息广播

1.  当整个服务框架在启动过程中，或是当 Leader 服务器出现网络中断崩溃退出与重启等异常情况时，ZAB 就会进入恢复模式并选举产生新的 Leader 服务器。
2.  当选举产生了新的 Leader 服务器，同时集群中已经有过半的机器与该 Leader 服务器完成了状态同步之后，ZAB 协议就会退出崩溃恢复模式，进入消息广播模式。
3.  当有新的服务器加入到集群中去，如果此时集群中已经存在一个 Leader 服务器在负责进行消息广播，那么新加入的服务器会自动进入数据恢复模式，找到 Leader 服务器，并与其进行数据同步，然后一起参与到消息广播流程中去。

以上其实大致经历了三个步骤：

1.  崩溃恢复：主要就是 Leader 选举过程
2.  数据同步：Leader 服务器与其他服务器进行数据同步
3.  消息广播：Leader 服务器将数据发送给其他服务器*